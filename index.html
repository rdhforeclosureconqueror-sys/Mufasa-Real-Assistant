<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mufasa Real Assistant</title>
  <link rel="icon" href="data:,">

  <style>
    :root{
      --bg:#050505; --gold:#d4af37; --text:#f2f2f2; --muted:#bdbdbd;
      --card: rgba(0,0,0,.35);
      --line: rgba(212,175,55,.35);
    }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 650px at 20% 10%, rgba(193,18,31,.18), transparent 55%),
        radial-gradient(1100px 650px at 80% 15%, rgba(27,127,58,.18), transparent 55%),
        radial-gradient(900px 550px at 50% 95%, rgba(212,175,55,.12), transparent 55%),
        var(--bg);
    }
    .wrap{ max-width:1200px; margin:0 auto; padding:18px; }
    .top{
      display:flex; justify-content:space-between; align-items:center;
      border:1px solid var(--line); border-radius:16px; padding:14px;
      background:rgba(0,0,0,.35);
    }
    .title{ font-weight:900; letter-spacing:.4px; }
    .sub{ font-size:12px; color:var(--muted); }
    .btn{
      border:1px solid rgba(212,175,55,.6);
      background:rgba(0,0,0,.25);
      color:var(--text);
      padding:10px 14px;
      border-radius:999px;
      cursor:pointer;
      font-weight:800;
    }
    .btn:hover{ background:rgba(212,175,55,.12); }
    .grid{
      display:grid;
      grid-template-columns: 2fr 1fr;
      gap:14px;
      margin-top:14px;
    }
    .panel{
      border:1px solid var(--line);
      border-radius:16px;
      padding:14px;
      background:var(--card);
    }
    textarea{
      width:100%;
      min-height:120px;
      background:#000;
      color:var(--text);
      border:1px solid var(--line);
      border-radius:12px;
      padding:12px;
      resize:vertical;
    }
    .prompts button{
      display:block;
      width:100%;
      text-align:left;
      margin:6px 0;
    }
    .chat{
      margin-top:10px;
      background:#000;
      border-radius:12px;
      padding:12px;
      max-height:360px;
      overflow:auto;
      border:1px solid var(--line);
    }
    .msg{ margin-bottom:10px; }
    .user{ color:#9fd3ff; }
    .ai{ color:#b7ffcc; }
  </style>
</head>

<body>
<div class="wrap">

  <!-- HEADER -->
  <div class="top">
    <div>
      <div class="title">ü¶Å Mufasa Real Assistant</div>
      <div class="sub">Static Site ‚Ä¢ Powered by Mufasa API</div>
    </div>
    <div>
      <button class="btn" id="micBtn">üé§ Mic</button>
      <button class="btn" id="slideshowBtn">üéûÔ∏è Create Slideshow</button>
      <button class="btn" id="langBtn">üåç English</button>
    </div>
  </div>

  <!-- MAIN -->
  <div class="grid">

    <!-- LEFT -->
    <div class="panel">
      <textarea id="input" placeholder="Ask Mufasa anything about Black history, culture, or timelines..."></textarea>
      <div style="margin-top:10px;">
        <button class="btn" id="sendBtn">Send</button>
      </div>

      <div class="chat" id="chat"></div>
    </div>

    <!-- RIGHT -->
    <div class="panel prompts">
      <strong>Quick Prompts</strong>
      <button class="btn">Explain the Mali Empire</button>
      <button class="btn">Give me a Haitian Revolution timeline</button>
      <button class="btn">Top Black inventors in history</button>
      <button class="btn">Teach me Ancient Africa</button>
      <button class="btn">From Timbuktu to Harlem</button>
    </div>

  </div>
</div>

<script>
/* ================= CONFIG ================= */
const API_BASE = "https://mufasa-real-assistant-api.onrender.com";

/* ================= STATE ================= */
let lang = "en";

/* ================= HELPERS ================= */
const chat = document.getElementById("chat");
const input = document.getElementById("input");

function addMsg(text, cls){
  const div = document.createElement("div");
  div.className = "msg " + cls;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

/* ================= ASK ================= */
async function ask(question){
  addMsg(question, "user");
  const r = await fetch(API_BASE + "/ask", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ question, lang })
  });
  const j = await r.json();
  addMsg(j.answer || "No response", "ai");
}

/* ================= EVENTS ================= */
document.getElementById("sendBtn").onclick = ()=>{
  if(input.value.trim()) ask(input.value.trim());
};

document.querySelectorAll(".prompts button").forEach(b=>{
  b.onclick = ()=>{
    input.value = b.textContent;
    ask(b.textContent);
  };
});

/* ================= MIC ================= */
const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
let rec;
if(SR){
  rec = new SR();
  rec.lang = "en-US";
  rec.onresult = e=>{
    input.value = e.results[0][0].transcript;
    ask(input.value);
  };
}
document.getElementById("micBtn").onclick = ()=>{
  if(rec) rec.start();
  else alert("Mic not supported");
};

/* ================= SLIDESHOW ================= */
document.getElementById("slideshowBtn").onclick = async ()=>{
  const text = input.value.trim();
  if(!text){ alert("Ask a question first"); return; }

  const r = await fetch(API_BASE + "/storyboard/create", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ topic: text })
  });
  const j = await r.json();
  localStorage.setItem("lastStoryboard", JSON.stringify(j));
  window.open(
    "/slideshow.html?api=" + encodeURIComponent(API_BASE) +
    "&id=" + encodeURIComponent(j.id),
    "_blank"
  );
};

/* ================= LANGUAGE ================= */
document.getElementById("langBtn").onclick = ()=>{
  if(lang === "en"){ lang="sw"; event.target.textContent="Swahili"; }
  else if(lang === "sw"){ lang="yo"; event.target.textContent="Yoruba"; }
  else{ lang="en"; event.target.textContent="English"; }
};
</script>
</body>
</html>
